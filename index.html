<meta charset="UTF-8">
<title>JSON Message</title>
<head f="ga">

</head>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<style>
@import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&display=swap');
.m5 {
  margin-left:5px
}
  * {font-family: 'Noto Sans TC', sans-serif;}
  p {-webkit-user-select: none;}
  .select {-webkit-user-select: none;}
/*tab*/
  .tab * {
  -webkit-user-select: none;
  }
.tab {
  position:fixed;
  top:0px;
  left:0px;
  width:100%;
  height:45px;
  background:#fff;
  display: flex;
  justify-content: center;
  align-items: center;
  flex-direction:row;
  border-bottom:1px #e3e3e3 solid;
}
.tab .t {
  height:45px;
  width:33.4%;
  max-width:80px;
  display: flex;
  justify-content: center;
  align-items: center;
  font-size:15px;
  font-weight:500;
  color:rgba(3, 71, 76, 1);
  font-family: 'Noto Sans TC', sans-serif;
  transition:0.3s;
}
.tab .t[s="1"] {
  background:rgba(3, 71, 76, 0);
  color:rgba(3, 71, 76, 1);
  font-weight:700;
}
.tline_box {
  width:100%;
  max-width:240px;
  height:3px;
  position:absolute;
  left:50%;
  transform:translateX(-50%);
  bottom:-1px;
}
.tline {
  position:absolute;
  left:0%;
  top:0px;
  background:rgba(3, 71, 76, 0);
  height:3px;
  width:33.4%;
  transition:0.3s;
}
.tlines {
  position:absolute;
  left:50%;
  top:0px;
  background:rgba(3, 71, 76, 1);
  height:3px;
  width:48px;
  transform:translateX(-50%);
  border-radius:8px 8px 0px 0px;
  transition:0.3s;
}
/*page*/
.allpage {
  width:300%;
  position:fixed;
  top:46px;
  left:0%;
  height:calc(100% - 46px);
  background:#fff;
  transition:0.3s;
}
.page {
  position:absolute;
  top:0px;
  width:33.33%;
  height:100%;
  background:#fff;
}
#p-json {
  left:0%;
  display: flex;
  justify-content: center;
  align-items: center;
  flex-direction:column;
}
#p-msgurl {
  left:33.33%;
  width:33.34%;
  display: flex;
  justify-content: center;
  align-items: center;
  flex-direction:column;
}
#p-flex {
  left:66.67%;
  display: flex;
  justify-content: center;
  align-items: center;
  flex-direction:column;
}
/*card*/
.preview {
  position:absolute;
  top:0px;
  left:0px;
  width:100%;
  max-height:30%;
  background:url(https://erichsia7.github.io/Flex-message/image/F92B4F77-00AD-462A-A17F-09F1B7559015.jpeg);
  background-size:cover;
  background-position:center;
  padding-top:20px;
  padding-bottom:20px;
  overflow:scroll;
}
.card {
  width:250px;
  min-height:350px;
  border-radius:12px;
  background:#fff;
  position:relative;
  left:50%;
  transform:translateX(-50%);
  overflow:hidden;
}
.hero img {
  height:150px;
  width:100%;
  object-fit:cover;
  overflow:hidden;
  border-radius:12px 12px 0px 0px;
}
.bod {
  padding-left:8px;
}
.card h1 {
  padding:0px;
  margin:0px;
  font-family: 'Noto Sans TC', sans-serif;
  font-size:var(--font-size);
  line-height:var(--font-size);
}
  .degbtn {
    width:80px;
  height:45px;
  border-radius:12px;
  background:rgba(3, 71, 76, 1);
  color:#fff;
  display: flex;
  justify-content: center;
  align-items: center;
  font-family: 'Noto Sans TC', sans-serif;
  font-weight:700;
    -webkit-user-select: none;
  }
/*json*/
.json-text,.msg-text {
  width:95%;
  max-width:250px;
  padding:10px;
  border:none;
  background:#f5f5f5;
  height:180px;
  border-radius:12px;
  margin-top:20px;
  font-family: 'Noto Sans TC', sans-serif;
  line-height:18px;
  font-size:12px;
}
/*send*/
  .sendbar * {
    -webkit-user-select: none;
  }
.sendbar {
  position:absolute;
  left:0px;
  bottom:0px;
  width:100%;
  height:60px;
  background:#fff;
  display: flex;
  justify-content: center;
  align-items: center;
  flex-direction:row;
  border-top:1px #e3e3e3 solid;
}
.sbtn {
  width:calc(50% - 5px);
  height:45px;
  border-radius:12px;
  background:rgba(3, 71, 76, 1);
  color:#fff;
  display: flex;
  justify-content: center;
  align-items: center;
  font-family: 'Noto Sans TC', sans-serif;
  font-weight:700;
}
  #sharejson ,#geturl{
    width:calc(100% - 5px);
    max-width:350px;
  }
  
  
  /*copylink*/
  
  .shorturlbg {
  position:fixed;
  top:0px;
  left:0px;
  width:100%;
  height:100%;
  background:rgba(0, 0, 0, 0.6);
  -webkit-backdrop-filter: blur(15px);
backdrop-filter: blur(15px);
  display:none;
    -webkit-user-select: none;
}
.shorturl {
  width:280px;
  height:130px;
  background:#fff;
  position:fixed;
  top:50%;
  left:50%;
  transform:translate(-50%,-50%) scale(1.23);
  border-radius:15px;
  display:none;
  -webkit-user-select: none;
}
.shorturl h3 {
  color:rgba(3, 71, 76, 1);
  margin-left:10px;
  font-family: 'Noto Sans TC', sans-serif;
  font-weight:700;
  -webkit-user-select: none;
}
.shorturl input {
  border:none;
  border-bottom:2px rgba(3, 71, 76, 1) solid;
  background:rgba(3, 71, 76, 0.1);
  border-radius:0px;
  height:28px;
  width:260px;
  position:absolute;
  bottom:45px;
  left:10px;
  color:rgba(3, 71, 76, 1)
}
.shbot .copybtn {
  width:55px;
  height:35px;
  border-radius:10px;
  display: flex;
  justify-content: center;
  align-items: center;
  font-size:16px;
  font-weight:700;
  font-family: 'Noto Sans TC', sans-serif;
  background:rgba(0,0,0,0);
  position:absolute;
  right:5px;
  bottom:5px;
  color:rgba(3, 71, 76, 1);
  -webkit-user-select: none;
}
.shbot .closebtn {
  width:55px;
  height:35px;
  border-radius:10px;
  display: flex;
  justify-content: center;
  align-items: center;
  font-size:16px;
  font-weight:700;
  font-family: 'Noto Sans TC', sans-serif;
  background:rgba(0,0,0,0);
  position:absolute;
  bottom:5px;
  color:rgba(3, 71, 76, 1);
  right:65px;
  width:55px;
  -webkit-user-select: none;
}

.shbot {
  position:absolute;
  bottom:0px;
  left:0px;
  width:100%;
  -webkit-user-select: none;
}
  
  /*fri*/
  .fri * {
    transition:0.3s;
  }
  .fri {
  position:fixed;
  top:0px;
  left:0px;
  width:100%;
  height:100%;
  background:#fff;
  display: flex;
  justify-content: center;
  align-items: center;
}
.fri img {
  width:130px;
  height:130px;
  -webkit-user-select:none;
}
  .fri p {
  color:rgba(3, 71, 76, 1);
  font-family: 'Noto Sans TC', sans-serif;
  font-weight:700;
  -webkit-user-select:none;
}
.friaddbtn {
  width:calc(100% - 5px);
  max-width:350px;
  height:45px;
  border-radius:12px;
  background:rgba(3, 71, 76, 1);
  color:#fff;
  display: flex;
  justify-content: center;
  align-items: center;
  font-family: 'Noto Sans TC', sans-serif;
  font-weight:700;
  position:fixed;
  left:50%;
  transform:translateX(-50%);
  bottom:10px;
  -webkit-user-select:none;
}
  /*settings*/
  .settings {
  position:fixed;
  top:0px;
  left:0px;
  width:100%;
  height:100%;
  background:#fff;
  display:none;
}
.settingstitle {
  position:absolute;
  top:0px;
  left:0px;
  width:100%;
  height:45px;
   display: flex;
  justify-content: center;
  align-items: center;
  flex-direction:row;
  border-bottom:1px #e3e3e3 solid;
   font-size:15px;
  font-weight:700;
  color:rgba(3, 71, 76, 1);
  font-family: 'Noto Sans TC', sans-serif;
}
.settingscontent {
  position:absolute;
  top:46px;
  left:0px;
  width:100%;
  height:calc(100% - 46px);
  background:#fff;
  overflow-x:hidden;
overflow-y:scroll;
}
.settingscontent li {
  list-style:none;
  width:calc(100% - 8px);
  height:35px;
  display: flex;
  justify-content: left;
  align-items: center;
  flex-direction:row;
  border-bottom:1px #f5f5f5 solid;
  padding-left:8px;
  font-size:15px;
  font-weight:700;
  color:rgba(3, 71, 76, 1);
  font-family: 'Noto Sans TC', sans-serif;
}
.settingsswitch {
  position:absolute;
  right:30px;
  transform:translateY(2px)
}
.settingsswitch input {
  height:23px;
  padding:0px;
  margin:0px;
  box-sizing: border-box;
  border:none;
  background:rgba(0, 0, 0,0);
  transform:translateX(1px);
}
.settingsswitch input::before {
  content:'';
  background:#f5f5f5;
  width:40px;
  height:23px;
  position:absolute;
  top:0px;
  left:-1px;
  border-radius:99em;
  transition:0.3s;
}
.settingsswitch input:checked::before {
  background:rgba(3, 71, 76, 1);
}
.settingsswitch input::after {
  content:'';
  background:#fff;
  width:20px;
  height:20px;
  position:absolute;
  top:1.5px;
  left:0.5px;
  border-radius:99em;
  transition:0.3s;
}
.settingsswitch input:checked::after {
  content:'';
  background:#fff;
  width:20px;
  height:20px;
  position:absolute;
  top:1.5px;
  left:17.5px;
}
.settingsback {
  position:absolute;
  left:5px;
  top:5px;
  height:35px;
  width:35px;
  display: flex;
  justify-content: center;
  align-items: center;
  border-radius:99em;
}
.settingsback img {
  height:20px;
  width:20px;
}
  .settingsbtn {
    position:absolute;
  right:5px;
  top:5px;
  height:35px;
  width:35px;
  display: flex;
  justify-content: center;
  align-items: center;
  border-radius:99em;
  }
  .settingsbtn img {
  height:20px;
  width:20px;
}
</style>



<div class="tab">
  <div class="t" s="1" t="j" w="48" i="json">JSON</div>
  <div class="t" s="0" t="m" w="65" i="msgurl">MSGURL</div>
  <div class="t" s="0" t="f" w="48" i="flex">FLEX</div>
  <div class="settingsbtn">
    <img src="https://erichsia7.github.io/JSON-Message/image/settings.png">
  </div>
  <div class="tline_box">
    <div class="tline">
      <div class="tlines"></div>
    </div>
  </div>
</div>

<div class="allpage">
  <div class="page" id="p-json">
    <textarea class="json-text" placeholder="JSON"></textarea>
        <div class="select" id="jsontype">
<li value="1">Flex(JSON)</li>
<li value="2">其他(JSON)</li>
</div>
    <div class="sendbar">
      <div class="sbtn" id="sharejson">傳送</div>
    </div>
  </div>
  
  <div class="page" id="p-msgurl">
    <textarea class="msg-text" placeholder="Text or JSON"></textarea>
    <div class="select" id="msgurltype">
<li value="1">文字(Text)</li>
<li value="2">其他(JSON)</li>
</div>

    <div class="sendbar">
      <div class="sbtn" id="geturl">取得連結</div>
    </div>
  </div>
  
    <div class="page" id="p-flex"> 
    <div class="degbtn" ripple-onclick="window.open('https://developers.line.biz/flex-simulator/')">開啟</div>
    <p style="max-width:80%;word-break: break-all;">目前沒有簡易編輯器，請先使用LINE官方的完整編輯器。</p>
    <p style="max-width:80%;word-break: break-all;">提示：編輯完成後，按下右上角的"View as json"，並按下"Copy"，在這裡的"JSON"頁內的輸入框貼上，並選擇Flex。</p>
  </div>
</div>



<div class="shorturlbg">
</div>
<div class="shorturl">
  <h3>MSGURL</h3>
  <input type="text" id="shortinp" readonly="readonly">
  <div class="shbot">
    <div class="closebtn">關閉</div>
  <div class="copybtn">複製</div>
  </div>
</div>


<div class="settings">
  <div class="settingstitle">
    <div class="settingsback">
      <img src="https://erichsia7.github.io/JSON-Message/image/arrowhead-thin-outline-to-the-left.png">
    </div>
    設定
  </div>
  <div class="settingscontent">
    <li>
      減少動態效果
      <label for="removetransition" class="settingsswitch"><input type="checkbox" id="removetransition" name="removetransition"></label>
    </li>
  </div>
</div>



<div class="fri">
  <img src="https://erichsia7.github.io/JSON-Message/image/65997CA1-BCEC-4253-9D11-AAAD4606A66B.png">
</div>

<script src="https://erichsia7.github.io/ripple.js/ripple.min.js"></script>
<script charset="utf-8" src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
<script>
   var getUrlString = location.href;
var url = new URL(getUrlString);
var co = url.searchParams.get('c') ;
function genid(mode) {
if(mode === "random"){
var genidchars = "0123456789abcdefghijklmnopqrstuvwxyz";
            var genid = "";
            for (var i = 0; i < 16; i++) {
                var genrandomNumber = Math.floor(Math.random() * genidchars.length);
                genid += genidchars.substring(genrandomNumber, genrandomNumber + 1);
            }
  return genid ;
}
          
 if(mode === "time"){
   var gtoday=new Date();
   var genid2 = (gtoday.getMonth()+1) + '_' + gtoday.getDate() + '_' + gtoday.getHours() + '_' + gtoday.getMinutes() + '_' + gtoday.getSeconds() + '-' + (1+Math.floor(Math.random() * 8)) + '' + (1+Math.floor(Math.random() * 8)) + '' + (1+Math.floor(Math.random() * 8)) + '' + (1+Math.floor(Math.random() * 8)) + '' + (1+Math.floor(Math.random() * 8)) + '' + (1+Math.floor(Math.random() * 8)) + '' + (1+Math.floor(Math.random() * 8)) + '' + (1+Math.floor(Math.random() * 8));
   
   return genid2
 }
  
  if(mode === "number"){
   
   var genid3 = '' ;
for (var i = 0; i < 16; i++) {
  genid3 += '' + (0+Math.floor(Math.random() * 9))
}
   return genid3
 }
  
  if(mode === "uuid"){
var genidchars4 = "abcdef012345678";
    var geniduu = [8,4,4,4,12];
            var genid4 = "";
            var genid5 = "";
    for (var ia = 0; ia < geniduu.length; ia++) {
      var genid4 = "";
            for (var i = 0; i < geniduu[ia]; i++) {
                var genrandomNumber4 = Math.floor(Math.random() * genidchars4.length);
                genid4 += genidchars4.substring(genrandomNumber4, genrandomNumber4 + 1);
            }
genid5 += '-' + genid4 ;
    }
    return genid5.substring(1,genid5.length)
  }

}
$('.t').click(function() {
  //json
  if($(this).attr('t') === 'j') {
    $('.tline').css({'left':'0%'});
    $('.allpage').css({'left':'0%'})
  }
  //msgurl
  if($(this).attr('t') === 'm') {
    $('.tline').css({'left':'33%'});
    $('.allpage').css({'left':'-100%'})
  }
  //flex
  if($(this).attr('t') === 'f') {
    $('.tline').css({'left':'67%'});
    $('.allpage').css({'left':'-200%'})
  }
  $('.t').attr('s','0');
  $(this).attr('s','1');
  $('.tlines').width(parseInt($(this).attr('w')));
});
  ripple('.t','rgba(3, 71, 76, 1)','0.4',1200,'true');
ripple('.sbtn,.degbtn','#fff','0.4',1200,'true');
  ripple('.copybtn,.closebtn,.settingsback,.settingsbtn','rgba(3, 71, 76, 1)','0.3',888,'true');

  
  
liff.init({
    liffId: "1656199368-GEwe5M5l" // Use own liffId
  })
  .then(() => {
    // Start to use liff's api
  //login
  if (!liff.isLoggedIn()) {
  liff.login({ redirectUri: "https://erichsia7.github.io/JSON-Message/" });
}
  //checkfriend
   liff.getFriendship().then(data => {
  if (data.friendFlag) {
    $('.fri').fadeOut('222')
  }
      else {
        $('.fri').append('<p>您必須先加入好友，才能使用這項功能。</p><div class="friaddbtn">加入好友</div>').css({'flex-direction':'column'});
        $('.friaddbtn').attr("ripple-onclick","location.href = 'https://line.me/R/ti/p/%40663xflop';");
        ripple('.friaddbtn','#fff','0.3',888,'true');
      }
     });
  //getname
  
  liff.getProfile()
.then(profile => {
  const name = profile.displayName ;
    
  //share
    $('#sharejson').click(function() {
      if($('#jsontype').attr('value') === "1") {
      if($('.json-text').val().indexOf('altText') > -1) {
     if (liff.isApiAvailable('shareTargetPicker')) {
  liff.shareTargetPicker([JSON.parse(String($('.json-text').val()))])
    .then(function (res) {
      if (res) {
       
        // succeeded in sending a message through TargetPicker
        console.log(`[${res.status}] Message sent!`);
        
      } else {
        const [majorVer, minorVer] = (liff.getLineVersion() || "").split('.');
        if (parseInt(majorVer) == 10 && parseInt(minorVer) < 11) {
          // LINE 10.3.0 - 10.10.0
          // Old LINE will access here regardless of user's action
          console.log('TargetPicker was opened at least. Whether succeeded to send message is unclear');
          
        } else {
          // LINE 10.11.0 -
          // sending message canceled
          console.log('TargetPicker was closed!');
          
        }
      }
    }).catch(function (error) {
      // something went wrong before sending a message
      console.log('something wrong happen');
    
    })
}      
      
      }
      else {
  if (liff.isApiAvailable('shareTargetPicker')) {
  liff.shareTargetPicker([JSON.parse(String('{"type": "flex","altText":"...","contents":' + $('.json-text').val() + '}'))])
    .then(function (res) {
      if (res) {
       
        // succeeded in sending a message through TargetPicker
        console.log(`[${res.status}] Message sent!`);
        
      } else {
        const [majorVer, minorVer] = (liff.getLineVersion() || "").split('.');
        if (parseInt(majorVer) == 10 && parseInt(minorVer) < 11) {
          // LINE 10.3.0 - 10.10.0
          // Old LINE will access here regardless of user's action
          console.log('TargetPicker was opened at least. Whether succeeded to send message is unclear');
          
        } else {
          // LINE 10.11.0 -
          // sending message canceled
          console.log('TargetPicker was closed!');
          
        }
      }
    }).catch(function (error) {
      // something went wrong before sending a message
      console.log('something wrong happen');
    
    })
}      
      }
        
        
      }
      else {
        //2
        
        if (liff.isApiAvailable('shareTargetPicker')) {
  liff.shareTargetPicker([JSON.parse(String($('.json-text').val()))])
    .then(function (res) {
      if (res) {
       
        // succeeded in sending a message through TargetPicker
        console.log(`[${res.status}] Message sent!`);
        
      } else {
        const [majorVer, minorVer] = (liff.getLineVersion() || "").split('.');
        if (parseInt(majorVer) == 10 && parseInt(minorVer) < 11) {
          // LINE 10.3.0 - 10.10.0
          // Old LINE will access here regardless of user's action
          console.log('TargetPicker was opened at least. Whether succeeded to send message is unclear');
          
        } else {
          // LINE 10.11.0 -
          // sending message canceled
          console.log('TargetPicker was closed!');
          
        }
      }
    }).catch(function (error) {
      // something went wrong before sending a message
      console.log('something wrong happen');
    
    })
}      
        
        
      }
    });    
  //shend    
})
.catch((err) => {
  console.log('error', err);
});
  })
  .catch((err) => {
    // Error happens during initialization
    console.log(err.code, err.message);
  });
  
  $('#geturl').click(function() {
    if($('#msgurltype').attr('value') === '1') {
      $('#shortinp').val('https://line.me/R/app/1656199368-Ov5Jvmvg?t=' + encodeURIComponent($('.msg-text').val()));
      $('.shorturlbg,.shorturl').fadeIn(222);
    }
    else {
      alert('目前不支援，後續將更新😚');
    }
  });
  $('.closebtn').click(function() {
    $('.shorturlbg,.shorturl').fadeOut(222);
    });
  $('.copybtn').click(function() { 
    var copys2 = $('.shorturl input');
copys2.select();
document.execCommand("Copy");
  });
  $('.settingsback').click(function() {
  $('.settings').fadeOut(222);
  });
  $('.settingsbtn').click(function() {
  $('.settings').fadeIn(222);
  });
  $('#removetransition').click(function() {
    $('*').css({'transition':'0s'});
  });
</script>
<script src="https://erichsia7.github.io/select.js/selsect.js"></script>
